<div class="dashboard-container">
  <h1>Financial Insights 2026</h1>

  <div class="chart-grid">
    <div class="chart-card">
      <h3>Spending by Card (Total)</h3>
      <div class="canvas-wrapper">
        <canvas baseChart
          [data]="barChartData"
          [options]="chartOptions"
          [type]="'bar'"
          (chartClick)="onChartClick($event)"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <h3>Spending by Category</h3>
      <div class="canvas-wrapper">
        <canvas baseChart
          [data]="doughnutChartData"
          [options]="chartOptions"
          [type]="'doughnut'"
          (chartClick)="onCategoryClick($event)"> 
        </canvas>
      </div>
    </div>
  </div>

<div class="transaction-section">
  <div class="table-header">
  <h3>
    Transactions 
    <!--{{ selectedCard() ? 'for ' + selectedCard() : '(All Cards)' }} -->
     <span *ngIf="selectedCard()">[Card: {{selectedCard()}}]</span>
      <span *ngIf="selectedCategory()">[Category: {{selectedCategory()}}]</span>
  </h3>
  <button *ngIf="selectedCard() || selectedCategory()" (click)="clearFilters()">
      Clear All Filters
    </button>
 </div> 
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Category</th>
        <th class="descr-col">Description</th> 
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      @for (t of filteredTransactions(); track t.id) {
        <tr>
          <td>{{ t.date | date:'shortDate' }}</td>
          <td>{{ t.category }}</td>
          <td class="descr-col">{{ t.description }}</td>
          <td>{{ t.amount | currency }}</td>
        </tr>
      }  @empty {
        <tr>
          <td colspan="4" style="text-align: center; padding: 2rem;">No transactions found for this filter.</td>
        </tr>
      }

    </tbody>
    <tfoot>
      <tr>
        <td colspan="2" class="total-label">Total Displayed:</td>
        <td class="descr-col"></td> <td class="total-amount">{{ tableTotal() | currency }}</td>
      </tr>
    </tfoot>
  </table>
</div>
</div>